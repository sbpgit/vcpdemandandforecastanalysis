<mvc:View
    controllerName="vcp.vcpdemandandforecastanalysis.controller.View1"
   xmlns:f="sap.f"
    xmlns:fb="sap.ui.comp.filterbar"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core"
    xmlns:viz="sap.viz.ui5.controls"
    xmlns:viz.data="sap.viz.ui5.data"
    xmlns:viz.feeds="sap.viz.ui5.controls.common.feeds"
    xmlns="sap.m"
>
    <!-- <Page title="Forecast Analysis"> -->
        <f:DynamicPage>
            <f:header>
                <f:DynamicPageHeader id="headerPin" pinnable="true" >
                    <fb:FilterBar
                        id="filterbar"
                        persistencyKey="myPersKey"
                        useToolbar="false"
                        search="onApplyFilters"
                        showClearOnFB="true"
                        clear="onClear"
                    >
                   <fb:filterGroupItems>
                            <fb:FilterGroupItem
                                name="Location"
                                label="Location"
                                groupName="Group1"
                                visibleInFilterBar="true"
                                mandatory="true"
                            >
                                <fb:control>
                                    <ComboBox
                                        id="idLocation"
                                        change=".onLocationChange"
                                        items="{path:'/'}"
                                        showSecondaryValues="true"
                                    >
                                        <core:ListItem
                                            key="{DEMAND_LOC}"
                                            text="{DEMAND_LOC}"
                                            additionalText="{DEMAND_DESC}"

                                        />
                                    </ComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem
                                name="ConfigurationProduct"
                                label="Configuration Product"
                                groupName="Group1"
                                visibleInFilterBar="true"
                                mandatory="true"
                            >
                                <fb:control>
                                    <ComboBox
                                        id="idConfigProduct"
                                        showSecondaryValues="true"
                                        items="{path: 'configModel>/ConfigProducts'}"
                                        change=".onConfigProductChange"
                                    >
                                        <core:ListItem
                                            key="{configModel>key}"
                                            text="{configModel>text}"
                                            additionalText="{configModel>desc}"
                                        />
                                    </ComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem
                                name="Product"
                                label="Product"
                                groupName="Group1"
                                visibleInFilterBar="true"
                                mandatory="true"
                            >
                                <fb:control>
                                    <!-- <Select
                                    id="idProduct"
                                    forceSelection="false"
                                    items="{/}"
                                    change=".onProductChange"
                                >
                                    <core:Item
                                        key="{PRODUCT_ID}"
                                        text="{PRODUCT_ID}"
                                    />
                                </Select> -->
                                    <ComboBox
                                        id="idProduct"
                                        items="{path:'/'}"
                                        showSecondaryValues="true"
                                        change=".onProductChange"
                                    >
                                        <core:ListItem
                                            key="{PRODUCT_ID}"
                                            text="{PRODUCT_ID}"
                                            additionalText="{PROD_DESC}"
                                        />
                                    </ComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem
                                name="ModelVersion"
                                label="Model Version"
                                groupName="Group1"
                                visibleInFilterBar="true"
                            >
                                <fb:control>
                                    <MultiComboBox
                                        id="idModelVersion"
                                        items="{path:'/'}"
                                        change=".onModelVersionChange"
                                    >
                                        <core:Item
                                            key="{MODEL_VERSION}"
                                            text="{MODEL_VERSION}"
                                        />
                                    </MultiComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem
                                name="UniqueID"
                                label="Unique ID"
                                groupName="Group1"
                                visibleInFilterBar="true"
                            >
                                <fb:control>
                                    <MultiComboBox
                                        id="idUniqueID"
                                        items="{path:'/'}"
                                        showSelectAll="true"
                                        selectionChange=".onUniqueIDChange"
                                    >
                                        <core:Item
                                            key="{UNIQUE_ID}"
                                            text="{UNIQUE_ID}"
                                        />
                                    </MultiComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <!-- <fb:FilterGroupItem
                                name="Asseembly"
                                label="Assembly"
                                groupName="Group1"
                                visibleInFilterBar="true"
                            >
                                <fb:control>
                                    <MultiComboBox
                                        id="idAssembly"
                                        items="{path: 'asmbModel>/items'}"
                                        showSelectAll="true"
                                        selectionChange=".onAssemblyChange"
                                    >
                                        <core:Item
                                            key="{asmbModel>ASSEMBLY_DESCRIPTION}"
                                            text="{asmbModel>ASSEMBLY_DESCRIPTION}"
                                        />
                                    </MultiComboBox>
                                </fb:control>
                            </fb:FilterGroupItem> -->

                            <fb:FilterGroupItem
                                name="DateRange"
                                label="Date Range"
                                groupName="Group1"
                                visibleInFilterBar="true"
                                mandatory="true"
                            >
                                <fb:control>
                                    <DateRangeSelection
                                        id="DRS1"
                                        change=".onDateRangeChange"
                                        displayFormat="dd/MM/yyyy"
                                        delimiter=" - "
                                    />
                                </fb:control>
                            </fb:FilterGroupItem>
                        </fb:filterGroupItems>
                    </fb:FilterBar>
                </f:DynamicPageHeader>
            </f:header>
            <f:content>
                <VBox>
                    <HBox
                        fitContainer="true"
                        justifyContent="SpaceAround"
                        wrap="NoWrap"
                        width="100%"
                    >
                        <VBox width="100%">
                            <Panel headerText="Product">
                                <viz:VizFrame
                                    id="idVizFrame"
                                    vizType="stacked_bar"
                                    uiConfig="{applicationSet:'fiori'}"
                                    width="100%"
                                >
                                    <viz:dataset>
                                        <viz.data:FlattenedDataset
                                            data="{/chartData}"
                                        >
                                            <viz.data:dimensions>
                                                <viz.data:DimensionDefinition
                                                    name="Product"
                                                    value="{Product}"
                                                />
                                            </viz.data:dimensions>
                                            <viz.data:measures>
                                                <viz.data:MeasureDefinition
                                                    name="Unconsumed"
                                                    value="{Forecast}"
                                                />
                                                <viz.data:MeasureDefinition
                                                    name="Sales"
                                                    value="{Actual}"
                                                />
                                            </viz.data:measures>
                                        </viz.data:FlattenedDataset>
                                    </viz:dataset>
                                    <viz:feeds>
                                        <viz.feeds:FeedItem
                                            uid="categoryAxis"
                                            type="Dimension"
                                            values="Product"
                                        />
                                        <viz.feeds:FeedItem
                                            uid="valueAxis"
                                            type="Measure"
                                            values="Unconsumed,Sales"
                                        />
                                    </viz:feeds>
                                </viz:VizFrame>
                            </Panel>
                            <Panel
                                headerText="Characteristic Value"
                                class="sapUiSmallMarginTop"
                            >
                                <viz:VizFrame
                                    id="idCharChart"
                                    vizType="combination"
                                    width="100%"
                                >
                                    <viz:dataset>
                                        <viz.data:FlattenedDataset
                                            data="{/CharData}"
                                        >
                                            <viz.data:dimensions>
                                                <viz.data:DimensionDefinition
                                                    name="Year Quarter"
                                                    value="{YEAR_QUAETER}"
                                                />
                                                <viz.data:DimensionDefinition
                                                    name="Characteristic"
                                                    value="{CHAR_DESC}"
                                                />
                                                <viz.data:DimensionDefinition
                                                    name="Char Value"
                                                    value="{CHARVAL_NUM}"
                                                />
                                            </viz.data:dimensions>
                                            <viz.data:measures>
                                                <viz.data:MeasureDefinition
                                                    name="Sales"
                                                    value="{ACTUAL_QTY}"
                                                />
                                                <viz.data:MeasureDefinition
                                                    name="Unconsumed"
                                                    value="{UNCONSUMED_FORECAST}"
                                                />
                                                <viz.data:MeasureDefinition
                                                    name="Forecast"
                                                    value="{CIR_QTY}"
                                                />
                                            </viz.data:measures>
                                        </viz.data:FlattenedDataset>
                                    </viz:dataset>

                                    <viz:feeds>
                                        <viz.feeds:FeedItem
                                            uid="categoryAxis"
                                            type="Dimension"
                                            values="Year Quarter,Characteristic,Char Value"
                                        />

                                        <viz.feeds:FeedItem
                                            uid="valueAxis"
                                            type="Measure"
                                            values="Sales,Unconsumed"
                                        />

                                        <viz.feeds:FeedItem
                                            uid="valueAxis2"
                                            type="Measure"
                                            values="Forecast"
                                        />
                                    </viz:feeds>
                                </viz:VizFrame>
                            </Panel>
                        </VBox>
                        <VBox>
                            <VBox class="sapUiSmallMarginBegin sapUiTinyMarginBottom">
                                <Button
                                    id="charButton"
                                    text="Apply Filters"
                                    type="Emphasized"
                                    press="onAppFilter"
                                    width="40%"
                                />
                            </VBox>
                            <HBox class="sapUiSmallMarginBegin">
                                <VBox>
                                    <Panel
                                        headerText="Characteristics"
                                        width="100%"
                                    >
                                        <ScrollContainer
                                            vertical="true"
                                            horizontal="false"
                                            height="986px"

                                        >
                                            <List
                                                id="idCharacteristics"
                                                mode="MultiSelect"
                                                items="{charModel>/Characteristics}"
                                                selectionChange="onCharacteristicChange"
                                                rememberSelections="true"
                                            >
                                                <StandardListItem
                                                    title="{charModel>text}"
                                                />
                                            </List>
                                        </ScrollContainer>
                                    </Panel>
                                </VBox>
                                <VBox>
                                    <Panel
                                        headerText="Characteristic Values"
                                        class="sapUiSmallMarginBegin"
                                        width="100%"
                                        height="auto"
                                    >
                                        <ScrollContainer
                                            vertical="true"
                                            horizontal="false"
                                             height="986px"
                                        >
                                            <List
                                                id="idCharValNum"
                                                mode="MultiSelect"
                                                items="{/CharValNum}"
                                                selectionChange="onCharValueChange"
                                                rememberSelections="true"
                                            >
                                                <StandardListItem
                                                    title="{text}"
                                                    description="{char}"
                                                />
                                            </List>
                                        </ScrollContainer>
                                    </Panel>
                                </VBox>
                            </HBox>
                        </VBox>
                    </HBox>
                    <VBox class="sapUiSmallMarginTop">
                    <Toolbar style="Clear" design="Info">
                    <HBox alignItems="Center">
                    <Label text="MRP Group :" labelFor="idMRPG" class="sapUiSmallMarginEnd sapUiTinyMarginTop"/>
                    <!-- <ComboBox id="idMRPG" items="{path:'/'}">
                     <core:Item
                                            key="{MRP_GROUP}"
                                            text="{MRP_GROUP}"
                                        />
                    </ComboBox> -->
                      <MultiComboBox
                                        id="idMRPG"
                                        items="{path: 'mrpgModel>/items'}"
                                        showSelectAll="true"
                                        width="250px"
                                    >
                                        <core:Item
                                            key="{${mrpgModel>MRP_GROUP}.toUpperCase() !== 'NULL' ? ${mrpgModel>MRP_GROUP} : 'NULL'}"
                                            text="{${mrpgModel>MRP_GROUP}.toUpperCase() !== 'NULL' ? ${mrpgModel>MRP_GROUP} : 'NULL'}"
                                        />
                                    </MultiComboBox>
                    </HBox>
                    <ToolbarSeparator ></ToolbarSeparator>
                     <HBox alignItems="Center">
                    <Label text="MRP Type :" labelFor="idMRPT" class="sapUiSmallMarginEnd sapUiTinyMarginTop"/>
                    <!-- <ComboBox id="idMRPT" items="{path:'/'}">
                     <core:Item
                                            key="{MRP_TYPE}"
                                            text="{MRP_TYPE}"
                                        />
                    </ComboBox> -->
                      <MultiComboBox
                                        id="idMRPT"
                                        items="{path: 'mrptModel>/items'}"
                                        showSelectAll="true"
                                        width="250px"
                                        
                                    >
                                        <core:Item
                                            key="{${mrptModel>MRP_TYPE}.toUpperCase() !== 'NULL' ? ${mrptModel>MRP_TYPE} : 'NULL'}"
                                            text="{${mrptModel>MRP_TYPE}.toUpperCase() !== 'NULL' ? ${mrptModel>MRP_TYPE} : 'NULL'}"
                                        />
                                    </MultiComboBox>
                    </HBox>
                    <ToolbarSeparator ></ToolbarSeparator>
                     <HBox alignItems="Center">
                    <Label  text="Assembly :" labelFor="idAssembly" class="sapUiSmallMarginEnd sapUiTinyMarginTop"/>
                      <MultiComboBox
                                        id="idAssembly"
                                        items="{path: 'asmbModel>/items'}"
                                        showSelectAll="true"
                                        width="350px"
                                    >
                                        <core:Item
                                            key="{asmbModel>ASSEMBLY_DESCRIPTION}"
                                            text="{asmbModel>ASSEMBLY_DESCRIPTION}"
                                        />
                                    </MultiComboBox>
                    </HBox>
                    <ToolbarSeparator ></ToolbarSeparator>
                    <HBox >
                    <Button id="mrpButton" text="Apply Filters" type="Emphasized" press="onMRPFilters"></Button>
                    <!-- <ToolbarSeparator class="sapUiSmallMarginBegin sapUiTinyMarginTop" ></ToolbarSeparator> -->
                    <Button id="mrpClr" text="Clear Filters" type="Emphasized" press="mrpClear" class="sapUiSmallMarginBegin"></Button>
                    </HBox>
                    </Toolbar>
                    </VBox>
                    <HBox class="sapUiSmallMarginBottom">
                        <VBox
                            width="100%"
                            class="sapUiSmallMarginTop"
                        >
                            <Panel
                                headerText="Forecast Quantity per Assembly, Week"
                            >
                                <viz:VizFrame
                                    id="idForecastChart"
                                    vizType="line"
                                    uiConfig="{applicationSet:'fiori'}"
                                    width="100%"
                                >
                                    <viz:dataset>
                                        <viz.data:FlattenedDataset
                                            data="{/ForecastChartData}"
                                        >
                                            <viz.data:dimensions>
                                                <viz.data:DimensionDefinition
                                                    name="Week"
                                                    value="{WEEK_DATE}"
                                                />

                                                <viz.data:DimensionDefinition
                                                    name="Assembly"
                                                    value="{ASSEMBLY_DESC}"
                                                />
                                            </viz.data:dimensions>

                                            <viz.data:measures>
                                                <viz.data:MeasureDefinition
                                                    name="Forecast Quantity"
                                                    value="{FORECAST_QTY}"
                                                />
                                            </viz.data:measures>
                                        </viz.data:FlattenedDataset>
                                    </viz:dataset>

                                    <viz:feeds>
                                        <viz.feeds:FeedItem
                                            uid="valueAxis"
                                            type="Measure"
                                            values="Forecast Quantity"
                                        />

                                        <viz.feeds:FeedItem
                                            uid="categoryAxis"
                                            type="Dimension"
                                            values="Week"
                                        />

                                        <viz.feeds:FeedItem
                                            uid="color"
                                            type="Dimension"
                                            values="Assembly"
                                        />
                                    </viz:feeds>
                                </viz:VizFrame>
                            </Panel>
                        </VBox>
                        <VBox
                            width="100%"
                            class="sapUiSmallMarginTop"
                        >
                            <Panel
                                headerText="Actual Quantity per Assembly, Week"
                                class="sapUiSmallMarginBegin"
                            >
                                <viz:VizFrame
                                    id="idActualChart"
                                    vizType="line"
                                    width="100%"
                                >
                                    <viz:dataset>
                                        <viz.data:FlattenedDataset
                                            data="{/ActualChartData}"
                                        >
                                            <viz.data:dimensions>
                                                <viz.data:DimensionDefinition
                                                    name="Week"
                                                    value="{WEEK_DATE}"
                                                />
                                                <viz.data:DimensionDefinition
                                                    name="Assembly"
                                                    value="{ASSEMBLY_DESC}"
                                                />
                                            </viz.data:dimensions>
                                            <viz.data:measures>
                                                <viz.data:MeasureDefinition
                                                    name="Actual Quantity"
                                                    value="{FORECAST_QTY}"
                                                />
                                            </viz.data:measures>
                                        </viz.data:FlattenedDataset>
                                    </viz:dataset>
                                    <viz:feeds>
                                        <viz.feeds:FeedItem
                                            uid="valueAxis"
                                            type="Measure"
                                            values="Actual Quantity"
                                        />
                                        <viz.feeds:FeedItem
                                            uid="categoryAxis"
                                            type="Dimension"
                                            values="Week"
                                        />
                                        <viz.feeds:FeedItem
                                            uid="color"
                                            type="Dimension"
                                            values="Assembly"
                                        />
                                    </viz:feeds>
                                </viz:VizFrame>
                            </Panel>
                        </VBox>
                    </HBox>
                </VBox>
            </f:content>
        </f:DynamicPage>
    <!-- </Page> -->
</mvc:View>